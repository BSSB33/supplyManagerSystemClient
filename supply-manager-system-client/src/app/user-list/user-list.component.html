<div class="panel panel-default" style="margin: 20px;">
    <h2 *ngIf="authService.user.role === 'ROLE_ADMIN'; else directorTitle" style="margin-left: 20px;">Registered Users</h2>
    <ng-template #directorTitle>
        <h2 *ngIf="authService.user.role === 'ROLE_DIRECTOR'; else managerTitle" style="margin-left: 20px;">Employees</h2>
    </ng-template>
    <ng-template #managerTitle>
        <h2 *ngIf="authService.user.role === 'ROLE_MANAGER'" style="margin-left: 20px;">Colleagues</h2>
    </ng-template>

    <table class="table table-dark table-hover table-curved">
        <thead>
            <tr>
                <th scope="col">Id</th>
                <th scope="col">Username</th>
                <th scope="col">User Status</th>
                <th scope="col">Director At</th>
                <th scope="col">Workplace</th>
                <th scope="col">Role</th>
                <th scope="col">Edit</th>
                <th scope="col">Disable/Enable</th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let user of users">
                <th scope="row">{{ user.id }}</th>
                <td *ngIf="user.username; else missing">
                    <a [routerLink]="['/users', user.id]" style="color: azure;">{{user.username}}</a>
                </td>

                <td *ngIf="user.enabled; else disabledUser"><label style="color: green;">Enabled User</label></td>
                <ng-template #disabledUser>
                    <td><label style="color: red;">Disabled User</label></td>
                </ng-template>

                <td *ngIf="user.company; else notADirector">{{user.company.name}}</td>
                <td *ngIf="user.workplace; else missing">{{user.workplace.name}}</td>
                <td *ngIf="user.role; else missing">{{user.role}}</td>

                <td *ngIf="authService.user.role !== 'ROLE_MANAGER'; else manager">
                    <button mat-raised-button color="primary" [routerLink]="['/users/edit', user.id]"><mat-icon>edit</mat-icon>&nbsp;Edit</button>
                </td>
                <ng-template #manager>
                    <td>
                        <button mat-raised-button color="primary" disabled><mat-icon>edit</mat-icon>&nbsp;Edit</button>
                    </td>
                </ng-template>

                <td *ngIf="user.enabled && authService.user.id === user.id || user.enabled && authService.user.role === 'ROLE_MANAGER'; else switchableUser">
                    <button mat-raised-button color="warn" disabled><mat-icon>remove_circle</mat-icon>&nbsp;Disable</button>
                </td>
                <ng-template #switchableUser>
                    <td *ngIf="user.enabled; else disabledUserButton">
                        <button mat-raised-button color="warn" (click)="openDisableUserDialog(user, 'disable')"><mat-icon>remove_circle</mat-icon>&nbsp;Disable</button>
                    </td>
                </ng-template>
                <ng-template #disabledUserButton>
                    <td><button mat-raised-button color="warn" (click)="openDisableUserDialog(user, 'enable')"><mat-icon>remove_circle_outline</mat-icon>&nbsp;Enable</button></td>
                </ng-template>
                
            </tr>
        </tbody>
    </table>

    <ng-template #notADirector>
        <td><strong style="color: orange;">Not a Director</strong></td>
    </ng-template>

    <ng-template #missing>
        <td><strong style="color: green;">Please Add Value</strong></td>
    </ng-template>
</div>